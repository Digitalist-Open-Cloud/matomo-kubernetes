/*!!
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * All information contained herein is, and remains the property of InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */
(function(){var k=false;var p=true;var o=null;var j="FIELD_CHECKABLE";var w="FIELD_SELECTABLE";var h="FIELD_TEXT";var m=["password","text","url","tel","email","search","",null];var a=["color","date","datetime","datetime-local","month","number","range","time","week"];var b=["radio","checkbox"];var n=["button","submit","hidden","reset"];var s=1750;var x=[];function e(){if(k&&"undefined"!==typeof console&&console&&console.debug){console.debug.apply(console,arguments)}}var c={getAttribute:function(z,y){if(z&&z.getAttribute&&y){return z.getAttribute(y)}return null},hasClass:function(z,y){if(!z||!z.className){return false}return(" "+z.className+" ").indexOf(" "+y+" ")>-1},hasNodeAttribute:function(z,y){if(z&&z.hasAttribute){return z.hasAttribute(y)
}if(z&&z.attributes){var A=(typeof z.attributes[y]);return A!=="undefined"}return false},isIgnored:function(y){if(this.hasNodeAttribute(y,"data-matomo-ignore")){return true}if(this.hasNodeAttribute(y,"data-piwik-ignore")){return true}return false},getTagName:function(y){if(y&&y.tagName){return(""+y.tagName).toLowerCase()}return null},findAllFormElements:function(y){if(y&&y.querySelectorAll){return y.querySelectorAll("form, [data-piwik-form], [data-matomo-form]")}return[]},findAllFieldElements:function(y){if(y&&y.querySelectorAll){return y.querySelectorAll("input,select,textarea,button,textarea")}return[]},findFormTrackerInstance:function(z,y){if("undefined"===typeof y){y=100}if(y<=0||!z){return null}if(z.formTrackerInstance){return z.formTrackerInstance}if(z.parentNode){return this.findFormTrackerInstance(z.parentNode,--y)}}};var t={isArray:function(y){return typeof y==="object"&&y!==null&&typeof y.length==="number"},indexOfArray:function(A,z){if(!A){return -1}if(A.indexOf){return A.indexOf(z)
}if(!this.isArray(A)){return -1}for(var y=0;y<A.length;y++){if(A[y]===z){return y}}return -1},getCurrentTime:function(){return new Date().getTime()},isNumber:function(y){return !isNaN(y)},generateUniqueId:function(){var B="";var z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var A=z.length;for(var y=0;y<6;y++){B+=z.charAt(Math.floor(Math.random()*A))}return B},paramsToQueryString:function(A){if(!A){A={}}var z="";for(var y in A){if(Object.prototype.hasOwnProperty.call(A,y)){if(A[y]===null){continue}z+=y+"="+encodeURIComponent(A[y])+"&"}}return z}};var g={getPiwikTrackers:function(){if(null===o){if("object"===typeof Piwik&&Piwik.getAsyncTrackers){return Piwik.getAsyncTrackers()}}if(t.isArray(o)){return o}return[]},trackParams:function(D,C){if(!p){return}var A=t.paramsToQueryString(D);if(!A||A===""){return}var y=this.getPiwikTrackers();if(y&&y.length){var z=0,B;for(z;z<y.length;z++){B=y[z];if(C&&500===B.getLinkTrackingTimer()&&B.setLinkTrackingTimer){B.setLinkTrackingTimer(650)
}if(B&&(!B.FormAnalytics||B.FormAnalytics.isEnabled())){B.trackRequest(A,null,null,"FormAnalytics")}}}if(k){e("trackProgress: "+Piwik.JSON.stringify(D))}}};function f(){if(typeof window==="object"&&"function"===typeof window.piwikFormAnalyticsAsyncInit){window.piwikFormAnalyticsAsyncInit()}}function r(y){this.reset();this.fields=[];this.firstFieldEngagementDate=null;this.lastFieldEngagementDate=null;this.hesitationTimeTracked=false;this.formStartTracked=false;this.node=y;this.formId=c.getAttribute(y,"id");this.formName=c.getAttribute(y,"data-matomo-name");if(!this.formName){this.formName=c.getAttribute(y,"data-piwik-name")}if(!this.formName){this.formName=c.getAttribute(y,"name")}this.entryFieldName="";this.exitFieldName="";this.lastFocusedFieldName="";this.fieldsWithUpdates=[];this.fieldNodes=[];this.initialFormViewLoggedWithTrackers=[];this.trackingTimeout=null;this.timeLastTrackingRequest=0;this.timeOffWindowBeforeEngagement=0;this.timeOffWindowSinceEngagement=0;Piwik.DOM.addEventListener(window,"focus",(function(z){return function(){if(!z.timeWindowBlur){return
}var A=t.getCurrentTime()-z.timeWindowBlur;z.timeWindowBlur=null;if(A<0){A=0}if(z.timeLastTrackingRequest){z.timeLastTrackingRequest=z.timeLastTrackingRequest+A}if(z.firstFieldEngagementDate){z.timeOffWindowSinceEngagement+=A;e("time off engaged "+z.timeOffWindowSinceEngagement)}else{z.timeOffWindowBeforeEngagement+=A;e("time off not engaged "+z.timeOffWindowBeforeEngagement)}}})(this));Piwik.DOM.addEventListener(window,"blur",(function(z){return function(){z.timeWindowBlur=t.getCurrentTime();e("window blur")}})(this));Piwik.DOM.addEventListener(y,"submit",(function(z){return function(){e("form submit");z.trackFormSubmit()}})(this))}r.prototype.reset=function(){this.detectionDate=t.getCurrentTime();this.formViewId=t.generateUniqueId();this.fieldsWithUpdates=[];this.firstFieldEngagementDate=null;this.lastFieldEngagementDate=null;this.timeOffWindowSinceEngagement=0;this.timeOffWindowBeforeEngagement=0;this.formStartTracked=false;if(this.fields&&this.fields.length){for(var y=0;y<this.fields.length;
y++){this.fields[y].resetOnFormSubmit()}}};r.prototype.trackFormSubmit=function(){this.setEngagedWithForm();var y=this.lastFieldEngagementDate-this.firstFieldEngagementDate-this.timeOffWindowSinceEngagement;if(y<0){y=0}var z={fa_su:1,fa_tts:y};this.sendUpdate(this.fields,z,true);this.reset()};r.prototype.trackFormConversion=function(){if(!this.timeLastTrackingRequest){this.sendUpdate([],{fa_co:1});return}var y=(t.getCurrentTime()-this.timeLastTrackingRequest)/1000;if(y<2){var z=this;setTimeout(function(){z.sendUpdate([],{fa_co:1})},800)}else{this.sendUpdate([],{fa_co:1})}};r.prototype.shouldBeTracked=function(){return !!this.fields&&!!this.fields.length};r.prototype.trackInitialFormView=function(){if(!this.initialFormViewLoggedWithTrackers||!this.initialFormViewLoggedWithTrackers.length){this.initialFormViewLoggedWithTrackers=g.getPiwikTrackers();this.sendUpdate([],{fa_fv:"1"})}};r.prototype.setEngagedWithForm=function(y){this.lastFieldEngagementDate=t.getCurrentTime();if(!this.firstFieldEngagementDate){this.firstFieldEngagementDate=this.lastFieldEngagementDate
}};r.prototype.trackFieldUpdate=function(y){if(t.indexOfArray(this.fieldsWithUpdates,y)===-1){this.fieldsWithUpdates.push(y)}this.scheduleSendUpdate()};r.prototype.scheduleSendUpdate=function(){if(this.trackingTimeout){clearTimeout(this.trackingTimeout);this.trackingTimeout=null}var y=this;this.trackingTimeout=setTimeout(function(){var z=y.fieldsWithUpdates;y.fieldsWithUpdates=[];y.sendUpdate(z)},s)};r.prototype.sendUpdate=function(B,E,D){if(!this.shouldBeTracked()){return}if(this.trackingTimeout){clearTimeout(this.trackingTimeout);this.trackingTimeout=null}if(!B){B=[]}var y=[];for(var A=0;A<B.length;A++){y.push(B[A].getTrackingParams())}var C={fa_vid:this.formViewId,fa_id:this.formId,fa_name:this.formName};if(this.entryFieldName){C.fa_ef=this.entryFieldName}if(this.exitFieldName){C.fa_lf=this.exitFieldName}if(y.length){C.fa_fields=Piwik.JSON.stringify(y)}if(this.firstFieldEngagementDate){if(!this.formStartTracked){C.fa_st="1";this.formStartTracked=true}if(!this.hesitationTimeTracked){C.fa_ht=this.firstFieldEngagementDate-this.detectionDate-this.timeOffWindowBeforeEngagement;
this.hesitationTimeTracked=true}if(this.lastFieldEngagementDate&&this.timeLastTrackingRequest){C.fa_ts=this.lastFieldEngagementDate-this.timeLastTrackingRequest;if(C.fa_ts<0){C.fa_ts=0}}else{if(this.lastFieldEngagementDate&&!this.timeLastTrackingRequest){C.fa_ts=this.lastFieldEngagementDate-this.firstFieldEngagementDate-this.timeOffWindowSinceEngagement;if(C.fa_ts<0){C.fa_ts=0}}}this.timeLastTrackingRequest=t.getCurrentTime()}if(E){for(var z in E){if(Object.prototype.hasOwnProperty.call(E,z)){C[z]=E[z]}}}if("undefined"===typeof D){D=false}g.trackParams(C,D)};r.prototype.scanForFields=function(){var B,A=0,E,D,z;D=c.findAllFieldElements(this.node);for(B=0;B<D.length;B++){if(!D[B]){continue}z=D[B];if(c.isIgnored(z)||t.indexOfArray(this.fieldNodes,z)>-1){continue}var y=c.getTagName(z);var C=c.getAttribute(z,"type");if(t.indexOfArray(n,C)!==-1){continue}else{if("button"===y){continue}}if(y==="input"&&!C){C="text"}var F=c.getAttribute(z,"data-matomo-name");if(!F){F=c.getAttribute(z,"data-piwik-name");
if(!F){F=c.getAttribute(z,"name");if(!F){F=c.getAttribute(z,"id");if(!F){continue}}}}this.fieldNodes.push(z);var G=false;for(A=0;A<this.fields.length;A++){if(this.fields[A]&&this.fields[A].fieldName===F){G=true;this.fields[A].addNode(z);break}}if(!G){E=new u(this,D[B],y,C,F);this.addFormField(E)}}};r.prototype.addFormField=function(y){this.fields.push(y)};function u(C,B,A,z,D){this.discoveredDate=t.getCurrentTime();this.tracker=C;this.timespent=0;this.hesitationtime=0;this.nodes=[];this.tagName=A;this.fieldName=D;this.fieldType=z;this.startFocus=null;this.timeLastChange=null;this.numChanges=0;this.numFocus=0;this.numDeletes=0;this.numCursor=0;this.canCountChange=true;this.isFocusedCausedAuto=c.hasNodeAttribute(B,"autofocus");if(this.tagName==="select"){this.category=w}else{if(this.tagName==="textarea"){this.category=h}else{if(t.indexOfArray(b,this.fieldType)!==-1){this.category=j}else{if(t.indexOfArray(a,this.fieldType)!==-1){this.category=w}else{this.category=h}}}}this.addNode(B);var y=(B===document.activeElement);
if(y){this.onFocus()}}u.prototype.addNode=function(z){this.nodes.push(z);function y(C,A,E){if(C&&"object"===typeof tinymce&&"function"===typeof tinymce.get&&c.getTagName(C)==="textarea"&&c.getAttribute(C,"id")){var D=c.getAttribute(C,"id");var B=tinymce.get(D);if(B){B.on(A,E);return}}else{if(C&&"function"===typeof jQuery&&c.getTagName(C)==="select"&&c.hasClass(C,"select2-hidden-accessible")&&C.nextSibling){if(A==="focus"){A="select2:open"}else{if(A==="blur"){A="select2:close"}}jQuery(C).on(A,E);return}}Piwik.DOM.addEventListener(C,A,E)}y(z,"focus",(function(A){return function(B){if(A.isAutoFocus()){e("field autofocus "+A.fieldName)}else{e("field focus "+A.fieldName)}A.onFocus()}})(this));y(z,"blur",(function(A){return function(){e("field blur "+A.fieldName);A.onBlur()}})(this));if(this.category===h){y(z,"keyup",(function(A){return function(D){var C=D.which||D.keyCode;var B=[9,16,17,18,20,27,91];if((C&&t.indexOfArray(B,C)!==-1)||D.isCtrlKey){return}if(C>=37&&C<=40){if(!A.isBlank()){A.numCursor++;
A.tracker.trackFieldUpdate(A)}return}if(C==8||C==46){if(!A.isBlank()){A.numDeletes++;A.tracker.trackFieldUpdate(A)}return}e("field text keyup "+A.fieldName);A.onChange()}})(this));y(z,"paste",(function(A){return function(){e("field text paste "+A.fieldName);A.onChange()}})(this))}else{y(z,"change",(function(A){return function(){e("field change "+A.fieldName);A.onChange()}})(this))}};u.prototype.resetOnFormSubmit=function(){this.hesitationtime=0;this.timespent=0;this.numFocus=0;this.numDeletes=0;this.numCursor=0;this.numChanges=0;this.startFocus=null;this.timeLastChange=null;this.canCountChange=true;this.hasChangedValueSinceFocus=false;this.isFocusedCausedAuto=false};u.prototype.isAutoFocus=function(){if(!this.isFocusedCausedAuto){return false}if(this.tracker.entryFieldName&&this.tracker.entryFieldName!==this.fieldName){this.isFocusedCausedAuto=false}if(this.tracker.exitFieldName&&this.tracker.exitFieldName!==this.fieldName){this.isFocusedCausedAuto=false}return this.isFocusedCausedAuto};
u.prototype.getTrackingParams=function(){return{fa_fts:this.getTimeSpent(),fa_fht:this.getHesitationTime(),fa_fb:this.isBlank(),fa_fn:this.fieldName,fa_fch:this.numChanges,fa_ff:this.numFocus,fa_fd:this.numDeletes,fa_fcu:this.numCursor,fa_ft:this.fieldType||this.tagName,fa_fs:this.getFieldSize()}};u.prototype.isBlank=function(){if(this.category===j){for(var y=0;y<this.nodes.length;y++){if(this.nodes[y]&&this.nodes[y].checked){return true}}return false}if(!this.nodes[0]){return false}var z=this.nodes[0];if("undefined"===typeof z.value){return true}var A=z.value;if(null===A||false===A||""===A){return true}return String(A).length===0};u.prototype.getFieldSize=function(){if(this.category===h){if(this.nodes[0]&&this.nodes[0].value){return String(this.nodes[0].value).length}else{return 0}}else{return -1}};u.prototype.getTimeSpent=function(){if(this.numChanges&&!this.timeSpent){this.timeSpent=1}if(!this.startFocus||this.isAutoFocus()){return this.timespent}if(this.timeLastChange){var y=this.timeLastChange-this.startFocus;
if(y<0){y=0}return this.timespent+y}return this.timespent+t.getCurrentTime()-this.startFocus};u.prototype.getHesitationTime=function(){if(this.numChanges||!this.startFocus||this.isAutoFocus()){return this.hesitationtime}var y=t.getCurrentTime();return this.hesitationtime+(y-this.startFocus)};u.prototype.onFocus=function(){this.startFocus=t.getCurrentTime();var y=this.fieldName!==this.tracker.lastFocusedFieldName;if(y&&this.tracker.lastFocusedFieldName){this.isFocusedCausedAuto=false}this.timeLastChange=null;this.hasChangedValueSinceFocus=false;this.tracker.lastFocusedFieldName=this.fieldName;if(y){this.canCountChange=true}if(y&&!this.isAutoFocus()){this.numFocus++;this.tracker.setEngagedWithForm();this.tracker.trackFieldUpdate(this);this.tracker.exitFieldName=this.fieldName;this.tracker.scheduleSendUpdate()}};u.prototype.onBlur=function(){if(!this.startFocus){return}if(this.hasChangedValueSinceFocus){if(this.timeLastChange&&this.startFocus){this.timespent+=(this.timeLastChange-this.startFocus)
}this.timeLastChange=null;this.startFocus=null;return}if(!this.isAutoFocus()){var y=t.getCurrentTime();this.timespent+=y-this.startFocus;if(!this.numChanges){this.hesitationtime+=y-this.startFocus}this.tracker.setEngagedWithForm();this.tracker.trackFieldUpdate(this)}this.startFocus=null};u.prototype.onChange=function(){this.timeLastChange=t.getCurrentTime();if(this.isAutoFocus()){this.startFocus=this.timeLastChange}else{if(!this.startFocus){return}}this.isFocusedCausedAuto=false;this.hasChangedValueSinceFocus=true;if(!this.numChanges){this.hesitationtime+=this.timeLastChange-this.startFocus}if(this.canCountChange){this.numChanges++;this.canCountChange=false}if(!this.tracker.entryFieldName){this.tracker.entryFieldName=this.fieldName}this.tracker.setEngagedWithForm();this.tracker.trackFieldUpdate(this)};function v(A,y){if(!p){return}if(!document.querySelectorAll){return}var z;if(A&&A.formTrackerInstance){z=A.formTrackerInstance;z.scanForFields()}else{if(!c.isIgnored(A)){z=new r(A);z.scanForFields();
x.push(z);A.formTrackerInstance=z}}if(y&&z&&z.shouldBeTracked()){z.trackInitialFormView()}return z}function d(A){if("undefined"===typeof A){A=document}var y=c.findAllFormElements(A);for(var z=0;z<y.length;z++){v(y[z],true)}}function i(){var y=g.getPiwikTrackers();if(!y||!t.isArray(y)||!y.length){return}Piwik.DOM.onReady(function(){d(document)});Piwik.DOM.onLoad(function(){d(document)})}function l(y){if("undefined"!==typeof y.FormAnalytics){return}y.FormAnalytics={enabled:true,enable:function(){this.enabled=true},disable:function(){this.enabled=false},isEnabled:function(){return p&&this.enabled}}}function q(){if("object"===typeof window&&"object"===typeof window.Piwik&&"object"===typeof window.Piwik.FormAnalytics){return}if("object"===typeof window&&!window.Piwik){return}Piwik.FormAnalytics={element:c,utils:t,tracking:g,FormField:u,FormTracker:r,disableFormAnalytics:function(){p=false},enableFormAnalytics:function(){p=true},isFormAnalyticsEnabled:function(){return p},setPiwikTrackers:function(y){if(y===null){o=null;
return}if(!t.isArray(y)){y=[y]}o=y},setTrackingTimer:function(y){if(y<0){throw new Error("Delay needs to be at least zero")}s=parseInt(y,10)},enableDebugMode:function(){k=true},scanForForms:d,trackFormSubmit:function(z){var y=c.findFormTrackerInstance(z);if(y){y.trackFormSubmit()}},trackFormConversion:function(y,A){if("string"===typeof y||"string"===typeof A){g.trackParams({fa_vid:t.generateUniqueId(),fa_id:A,fa_name:y,fa_co:1});return}var z=c.findFormTrackerInstance(y);if(z){z.trackFormConversion()}},trackForm:function(y){return v(y,true)}};Piwik.addPlugin("FormAnalytics",{log:function(D){if(!p||!D||!D.tracker){return""}var A=D.tracker;if(A.FormAnalytics&&!A.FormAnalytics.isEnabled()){return""}var y=c.findAllFormElements(document);var C="";for(var z=0;z<y.length;z++){var B=v(y[z],false);if(B&&B.shouldBeTracked()&&t.indexOfArray(B.initialFormViewLoggedWithTrackers,A)===-1){B.initialFormViewLoggedWithTrackers.push(A);if(B.formViewId!==null){C+="&fa_fp["+z+"][fa_vid]="+encodeURIComponent(B.formViewId)
}if(B.formId!==null){C+="&fa_fp["+z+"][fa_id]="+encodeURIComponent(B.formId)}if(B.formName!==null){C+="&fa_fp["+z+"][fa_name]="+encodeURIComponent(B.formName)}C+="&fa_fp["+z+"][fa_fv]=1"}}if(C){e("sending request with pageview"+C);return"&fa_pv=1"+C}return""},unload:function(){var z;for(var y=0;y<x.length;y++){z=x[y];if(z&&z.trackingTimeout){e("before unload");clearTimeout(z.trackingTimeout);z.sendUpdate(z.fieldsWithUpdates,{},true)}}}});if(window.Piwik.initialized){Piwik.on("TrackerSetup",l);Piwik.retryMissedPluginCalls();f();i()}else{Piwik.on("TrackerSetup",l);Piwik.on("PiwikInitialized",function(){f();i()})}}if("object"===typeof window.Piwik){q()}else{if("object"!==typeof window.piwikPluginAsyncInit){window.piwikPluginAsyncInit=[]}window.piwikPluginAsyncInit.push(q)}})();
